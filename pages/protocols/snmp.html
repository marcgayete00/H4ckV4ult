<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Maven+Pro:wght@400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/H4ckV4ult/styles/navBarStyles.css">
    <link rel="stylesheet" href="/H4ckV4ult/styles/walkthroughs.css">
        <link href="/H4ckV4ult/styles/prism/prism.css" rel="stylesheet" />
    <script src="/H4ckV4ult/styles/prism/prism.js"></script>
    <title>Minimalist Webpage</title>

</head>
<body>
    <div id="navbar-container"></div>
    <script src="/H4ckV4ult/components/navbar.js"></script>

    <div class="notion-container">
        <div class="notion-header">
            <h1>SNMP (TCP/161 - TCP/162)</h1>
            <p>Simple Network Management Protocol (SNMP) is an Internet Standard protocol for collecting and organizing information about managed devices on IP networks and for modifying that information to change device behavior</p>
            <p>Port 161 is used by managers to send requests to agents and 162 port is used by agents to send notifications</p>
        </div>
        <div class="notion-body">
            <h2>Enumeration</h2>
            <ul>
                <h3>Version</h3>
                <ul>
                    <p>Version identification and connecting to the service</p>
                    <pre><code class="language-bash">telnet 10.129.242.130 25</code></pre>
                </ul>
                <h3>User enumeration</h3>
                <ul>
                    <p>Once we are inside the SNMP we are able to identify system users by using the follwing command. If the result code equals 252 means that the user exits</p>
                    <pre><code class="language-bash">VRFY root</code></pre>
                    <p>We are able to automate this by using the metasploit module <b>auxiliary/scanner/smtp/smtp_enum</b> or <b>smtp-user-enum</b></p>
                    <pre><code class="language-bash">smtp-user-enum -M VRFY -U /home/kali/Downloads/footprinting-wordlist.txt -t 10.129.242.130</code></pre>
                </ul>   
                
            </ul>

            <h2>Exploitation</h2>
            <p>The manufacturer default community strings of public and private are often unchanged</p>
            <p>In SNMP <b>versions 1 and 2c</b>, access is controlled using a plaintext community string, and if we know the name, we can gain access to it. Encryption and authentication were only added in <b>SNMP version 3</b></p>
            <ul>  
                <p>Using snmpwalk we can perform a query to a specific device. That strange number is the query that we would like to send. The <b>-v allows to select the SNMP version</b></p>
                <p>The diference between public and private (community strings) is that public is read only and private is read-write</p>
                <pre><code class="language-bash">snmpwalk -v2c -c public 10.129.42.253</code></pre>
                <pre><code class="language-bash">snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0</code></pre>
                <pre><code class="language-bash">snmpwalk -v 2c -c private 10.129.42.253 1.3.6.1.2.1.1.5.0</code></pre>
                <p>Some common queries are listed:</p>
                <table class="minimal-table">
                <tr>
                    <th class="header">Information</th>
                    <th class="header">OID</th>
                    <th class="header">Description</th>
                </tr>
                <tr>    
                    <th>sysDescr</th>
                    <th>1.3.6.1.2.1.1.1.0</th>
                    <th>OS version</th>
                </tr>
                <tr>
                    <th>sysUpTime</th>
                    <th>1.3.6.1.2.1.1.3.0</th>
                    <th>Time alive</th>
                </tr>
                <tr>
                    <th>sysContact</th>
                    <th>1.3.6.1.2.1.1.4.0</th>
                    <th>Contact of the admin</th>
                </tr>
                <tr>
                    <th>sysName</th>
                    <th>1.3.6.1.2.1.1.5.0</th>
                    <th>Hostname</th>
                </tr>
                <tr>
                    <th>sysLocation</th>
                    <th>1.3.6.1.2.1.1.6.0</th>
                    <th>Location</th>
                </tr>
                </table>
                		
		
		
		
		
		

            
            </ul>   
        </div>
    </div>
</body>
</html>